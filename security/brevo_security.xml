<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Brevo Security Groups -->
    <record id="group_brevo_manager" model="res.groups">
        <field name="name">Brevo Manager</field>
        <field name="category_id" ref="base.module_category_administration"/>
        <field name="comment">Full access to Brevo integration features</field>
    </record>

    <record id="group_brevo_user" model="res.groups">
        <field name="name">Brevo User</field>
        <field name="category_id" ref="base.module_category_administration"/>
        <field name="comment">Read-only access to Brevo integration features</field>
    </record>

    <!-- Record Rules -->
    <record id="brevo_config_rule_company" model="ir.rule">
        <field name="name">Brevo Config: Multi-Company</field>
        <field name="model_id" ref="model_brevo_config"/>
        <field name="domain_force">['|', ('company_id', '=', False), ('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('base.group_multi_company'))]"/>
    </record>

    <record id="brevo_contact_list_rule_company" model="ir.rule">
        <field name="name">Brevo Contact List: Multi-Company</field>
        <field name="model_id" ref="model_brevo_contact_list"/>
        <field name="domain_force">['|', ('company_id', '=', False), ('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('base.group_multi_company'))]"/>
    </record>

    <record id="brevo_sync_log_rule_company" model="ir.rule">
        <field name="name">Brevo Sync Log: Multi-Company</field>
        <field name="model_id" ref="model_brevo_sync_log"/>
        <field name="domain_force">['|', ('company_id', '=', False), ('company_id', 'in', company_ids)]</field>
        <field name="groups" eval="[(4, ref('base.group_multi_company'))]"/>
    </record>

    <!-- Webhook Security -->
    <record id="brevo_webhook_rule" model="ir.rule">
        <field name="name">Brevo Webhook: Public Access</field>
        <field name="model_id" ref="model_brevo_sync_log"/>
        <field name="domain_force">[(1, '=', 1)]</field>
        <field name="groups" eval="[(4, ref('base.group_public'))]"/>
    </record>

</odoo>
